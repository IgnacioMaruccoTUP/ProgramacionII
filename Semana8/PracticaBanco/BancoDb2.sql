USE [BancoDb2]
GO
/****** Object:  Table [dbo].[Cliente]    Script Date: 4/10/2024 10:32:06 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Cliente](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE] [varchar](100) NULL,
	[APELLIDO] [varchar](100) NULL,
	[DNI] [varchar](100) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CUENTA]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CUENTA](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CBU] [varchar](100) NULL,
	[SALDO] [decimal](18, 2) NULL,
	[TIPO_CUENTA_ID] [int] NULL,
	[ULTIMO_MOVIMIENTO] [datetime] NULL,
	[CLIENTE_ID] [int] NULL,
	[FECHA_BAJA] [datetime] NULL,
	[MOTIVO_BAJA] [varchar](100) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TIPO_CUENTA]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TIPO_CUENTA](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE] [varchar](100) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
SET IDENTITY_INSERT [dbo].[Cliente] ON 
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (1, N'PEPE', N'PEPITO', N'123456789')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (2, N'JUAN', N'JUANCITO', N'253545646')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (3, N'Diego', N'Pineda', N'23332')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (4, N'ivan', N'jdjdjd', N'454747')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (5, N'nombre', N'apellido', N'12345')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (6, N'federico', N'ventanal', N'43934543')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (7, N'mateo', N'dellacqua', N'42854808')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (8, N'Eze', N'Miarka', N'33478996')
GO
INSERT [dbo].[Cliente] ([ID], [NOMBRE], [APELLIDO], [DNI]) VALUES (9, N'paolo', N'pacheco', N'43450796')
GO
SET IDENTITY_INSERT [dbo].[Cliente] OFF
GO
SET IDENTITY_INSERT [dbo].[CUENTA] ON 
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (1, N'12344343', CAST(2344.00 AS Decimal(18, 2)), 1, CAST(N'2020-08-27T00:00:00.000' AS DateTime), 3, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (2, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-08-27T21:14:09.683' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (3, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-08-27T21:28:41.567' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (4, N'sdfsdfadas', CAST(0.00 AS Decimal(18, 2)), 1, CAST(N'2024-08-27T21:53:28.700' AS DateTime), 7, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (5, N'agus-asdasda', CAST(500.00 AS Decimal(18, 2)), 2, CAST(N'2024-08-27T21:59:36.847' AS DateTime), 7, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (6, N'paolin', CAST(70.00 AS Decimal(18, 2)), 4, CAST(N'2024-08-27T22:00:54.623' AS DateTime), 8, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (7, N'papa-123123asf', CAST(800.00 AS Decimal(18, 2)), 4, CAST(N'2024-08-27T22:04:33.380' AS DateTime), 9, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (8, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-08-27T22:08:58.093' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (9, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-01T19:16:24.247' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (10, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (11, N'405817172', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:44:59.347' AS DateTime), 1, CAST(N'2024-10-03T21:39:34.890' AS DateTime), N'defunciono')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (12, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-07T13:47:08.343' AS DateTime), 1, CAST(N'2024-10-03T20:34:34.893' AS DateTime), N'defuncion')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (13, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-07T13:47:50.027' AS DateTime), 1, CAST(N'2024-10-03T20:33:03.420' AS DateTime), N'mora')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (15, N'405817172', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:44:59.347' AS DateTime), 1, CAST(N'2024-10-03T21:38:35.587' AS DateTime), N'se cago muriendo')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (16, N'405817172', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:44:59.347' AS DateTime), 1, CAST(N'2024-10-03T21:37:14.807' AS DateTime), N'porque pinto')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (18, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (19, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (20, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (21, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (22, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (23, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-09-06T19:29:16.047' AS DateTime), 1, CAST(N'2024-10-03T21:42:12.730' AS DateTime), N'se muriooo el loco!')
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (24, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2019-09-06T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
INSERT [dbo].[CUENTA] ([ID], [CBU], [SALDO], [TIPO_CUENTA_ID], [ULTIMO_MOVIMIENTO], [CLIENTE_ID], [FECHA_BAJA], [MOTIVO_BAJA]) VALUES (25, N'405817171', CAST(1500.50 AS Decimal(18, 2)), 1, CAST(N'2024-10-01T19:29:16.047' AS DateTime), 1, NULL, NULL)
GO
SET IDENTITY_INSERT [dbo].[CUENTA] OFF
GO
SET IDENTITY_INSERT [dbo].[TIPO_CUENTA] ON 
GO
INSERT [dbo].[TIPO_CUENTA] ([ID], [NOMBRE]) VALUES (1, N'CREDITO')
GO
INSERT [dbo].[TIPO_CUENTA] ([ID], [NOMBRE]) VALUES (2, N'DEBITO')
GO
INSERT [dbo].[TIPO_CUENTA] ([ID], [NOMBRE]) VALUES (3, N'CHEQUES')
GO
INSERT [dbo].[TIPO_CUENTA] ([ID], [NOMBRE]) VALUES (4, N'MERCADOOOO')
GO
SET IDENTITY_INSERT [dbo].[TIPO_CUENTA] OFF
GO
ALTER TABLE [dbo].[CUENTA]  WITH CHECK ADD FOREIGN KEY([CLIENTE_ID])
REFERENCES [dbo].[Cliente] ([ID])
GO
ALTER TABLE [dbo].[CUENTA]  WITH CHECK ADD FOREIGN KEY([TIPO_CUENTA_ID])
REFERENCES [dbo].[TIPO_CUENTA] ([ID])
GO
/****** Object:  StoredProcedure [dbo].[ACTUALIZAR_CUENTA]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[ACTUALIZAR_CUENTA]
@ID INT,
@CBU VARCHAR(100),
@SALDO DECIMAL(18,2),
@ULTIMO_MOVIMIENTO DATETIME,
@TIPO_CUENTA_ID INT
AS
BEGIN
UPDATE CUENTA SET CBU = @CBU , 
ULTIMO_MOVIMIENTO = @ULTIMO_MOVIMIENTO,
TIPO_CUENTA_ID  = @TIPO_CUENTA_ID
WHERE ID = @ID
END;
GO
/****** Object:  StoredProcedure [dbo].[CREAR_CLIENTE]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[CREAR_CLIENTE]
@NOMBRE VARCHAR(100),
@APELLIDO VARCHAR(100),
@DNI VARCHAR(100)
AS
BEGIN
INSERT INTO  CLIENTE(NOMBRE,APELLIDO,
DNI)
VALUES(@NOMBRE,@APELLIDO,
@DNI)
END
GO
/****** Object:  StoredProcedure [dbo].[CREAR_CUENTA]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[CREAR_CUENTA]
@CBU VARCHAR(100),@SALDO DECIMAL(18,2),
@TIPO_CUENTA_ID INT,
@ULTIMO_MOVIMIENTO DATETIME,
@CLIENTE_ID INT
AS
BEGIN
INSERT INTO  CUENTA(CBU,SALDO,
TIPO_CUENTA_ID,ULTIMO_MOVIMIENTO,CLIENTE_ID)
VALUES(@CBU,@SALDO,
@TIPO_CUENTA_ID,@ULTIMO_MOVIMIENTO,@CLIENTE_ID)
END
GO
/****** Object:  StoredProcedure [dbo].[OBTENER_CLIENTES]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[OBTENER_CLIENTES]
AS
BEGIN
SELECT
ID,NOMBRE,APELLIDO,DNI
FROM CLIENTE
END
GO
/****** Object:  StoredProcedure [dbo].[OBTENER_CUENTAS]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[OBTENER_CUENTAS]
AS
BEGIN
SELECT
CU.ID,CBU,SALDO,TP.NOMBRE AS NOMBRE_CUENTA , TP.ID AS TIPO_CUENTA_ID , ULTIMO_MOVIMIENTO , CLIENTE_ID
FROM CUENTA CU
JOIN TIPO_CUENTA TP ON TP.ID = CU.TIPO_CUENTA_ID
END
GO
/****** Object:  StoredProcedure [dbo].[OBTENER_TIPOS_CUENTAS]    Script Date: 4/10/2024 10:32:07 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[OBTENER_TIPOS_CUENTAS]
AS
BEGIN
SELECT
ID,NOMBRE
FROM TIPO_CUENTA
END
GO
